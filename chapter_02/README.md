# 설치 
## 해당 단원에서 공부할만한 키워드 
### IPC(Inter-Process Communication)
- 프로세스 간 통신
- 프로세스들 사이에 서로 데이터를 주고받는 행위 또는 그에 대한 방법이나 경로 
- 주요 방식
  - 파일
  - 신호
  - 소켓
  - 메시지 큐
  - 파이프
  - 지명 파이프
  - 세마포어
  - 공유 메모리
  - 메시지 전달(비공유)
  - 메모리 맵 파일 

### 유닉스 도메인 소켓
- Unix Domain Socket
- IPC 소켓이라고도 함 
- TCP 소켓과 동일한 API로 데이터를 주고받을 수 있는 local file 기반의 소켓임 
- TCP 소켓과의 차이점
  - `local host`의 process 간 통신이기 때문에 속도가 매우 빠르고 메모리 소모가 적음 
- 대표적인 사용 예시
  - MySQL DBMS의 socket
  - PHP의 WAS인 PHP-FPM도 UDS 지원 


### MySQL 실행
- localhost일 경우 소켓 파일 사용
- 소켓 파일 위치는 MySQL 서버의 설정 파일에서 읽어서 사용함 
- MySQL 서버가 기동될 때 만들어지는 유닉스 소켓 파일은 MySQL 서버를 재시작하지 않으면 다시 만들 수 없으니 삭제 X
- 유닉스, 리눅스 : mysql 프로그램의 경로를 PATH 환경변수 등록 


### 서버 업그레이드 
- 인플레이스 업그레이드 
  - MySQL 서버의 데이터 파일을 그대로 두고 업그레이드
  - 단계적으로 업그레이드 해야 함 
- 논리적 업그레이드
  - mysqldump 도구 등을 이용해 MySQL 서버의 데이터를 SQL 문장이나 텍스트 파일로 덤프한 후, 새로 업그레이드된 버전의 MySQL 서버에서 덤프된 데이터를 적재하는 방법


## 시스템 변수 
- MySQL 서버가 기동하면서 설정 파일의 내용을 읽어 메모리나 작동 방식을 초기화하고, 접속된 사용자를 제어하기 위해 이러한 값을 별도로 저장해둔 값 
- 글로벌 변수 vs 세션 변수 
### 시스템 변수가 가지는 5가지 속성 
- Cmd-line : MySQL 서버의 명령행 인자로 설정될 수 있는지 여부를 나타냄. Yes일 경우 명령행 인자로 이 시스템 변수의 값을 변경하는 것이 가능하다는 의미
- Option file : MySQL의 설정 파일인 my.cnf로 제어할 수 있는지 여부를 나타냄.
- System var : 시스템 변수인지 아닌지를 나타냄.
- Var Scope : 시스템 변수의 적용 범위를 나타냄. 
  - 서버 전체(글로벌)인지, 서버와 클라이언트 간의 커넥션(세션)인지 구분 
  - 둘 다 적용되기도 함 
- Dynamic : 시스템 변수가 동적인지 정적인지 구분 


### 글로벌 변수와 세션 변수 
- 글로벌 범위의 시스템 변수
  - 하나의 MySQL 서버 인스턴스에서 전체적으로 영향을 미치는 시스템 변수를 의미 
  - 주로 MySQL 서버 자체에 관련된 설정일 떄가 많음 
  - 서버에서 단 하나만 존재하는 InnoDB 버퍼 풀 크기, MyISAM의 키 캐시 크기 등이 대표적인 글로벌 영역


- 세션 범위의 시스템 변수
  - 클라이언트가 MySQL 서버에 접속할 때 기본으로 부여하는 옵션의 기본값을 제어하는 데 사용 
  - 클라이언트의 필요에 따라 개별 커넥션 단위로 다른 값으로 변경할 수 있는 것이 세션 변수 
    - 기본값 = 글로벌 시스템 변수 
    - 각 클라이언트가 가지는 값 = 세션 변수
  - 각 클라이언트에서 쿼리 단위로 자동 커밋을 수행할지 여부를 결정하는 `autocommit`변수가 대표적인 예 
  - 한번 연결된 커넥션의 세션 변수는 서버에서 강제로 변경 불가


- Both로 명시된 시스템 변수 
  - MySQL 서버가 기억하고 있다가, 실제 클라이언트와의 커넥션이 생성되는 순간에 해당 커넥션의 기본값으로 사용되는 값


### 정적 변수와 동적 변수 
- 서버가 기동 중인 상태에서 변경 가능한지 여부에 따라 구분
  - MySQL 서버의 시스템 변수는 디스크에 저장돼 있는 설정 파일을 변경하는 경우와 이미 기동 중인 MySQL 서버의 메모리에 있는 MySQL 서버의 시스템 변수를 변경하는 경우로 구분 
- 디스크에 저장된 설정 파일의 내용은 변경하더라도 MySQL 서버가 재시작하기 전에는 적용되지 않음 
- 변수값 확인이나 SET 명령을 이용해 변수값을 바꿀 수 있음 
- SET 명령으로 변경되는 시스템 변숫값이 설정 파일인 my.cnf에 반영된 것은 아님
  - 현재 기동 중인 MySQL의 인스턴스에서만 유효 
  - 영구히 적용하려면 my.cnf 파일도 반드시 변경해야 함 
- MySQL 8.0부터는 SET PERSIST 명령을 이용하면 실행 중인 MySQL 서버의 시스템 변수를 변경함과 동시에 자동으로 설정 파일로도 기록 됨 
- SHOW, SET 명령에서 `GLOBAL`키워드를 사용하면 글로벌 시스템 변수의 목록과 내용을 읽고 변경 가능
  - `GLOBAL` 키워드를 빼면 자동으로 세션 변수를 조회하고 변경


- 동적 변수는 SET 명령으로 변수값을 변경하고, 서버를 재시작하지 않아도 됨
  - 설정 파일까지 변경하려면 SET PERSIST


- 시스템 변수의 범위가 Both인 경우 (글로벌 and 세션)
  - 시스템 변수 값을 변경해도 이미 존재하는 커넥션의 세션 변수 값은 변경되지 않고 유지됨 


### SET PERSIST 
- 동적 변수는 SET GLOBAL 명령으로 변경하면 즉시 MySQL 서버에 반영 됨 
  - 하지만 설정 파일 상에는 적용 안됨
  - 이 때문에 장애가 재발생 할 수 있으니 SET PERSIST를 쓰자 
- SET PERSIST 
  - 변경 값을 즉시 적용함과 동시에 별도의 설정 파일(mysqld-auto.cnf)에 변경된 내용을 추가로 기록 
  - 서버 재시작 시 기본 설정 파일 뿐만 아니라 mysqld-auto.cnf 파일을 같이 참조해서 시스템 변수 적용 
  - 해당 명령은 세션 변수에는 적용되지 않음 -> 글로벌 변수에만 적용 됨 
  - 서버에는 변경 내용을 기록하지 않고, mysqld-auto.cnf에만 변경 내용을 기록 해두고자 할 경우 `SET PERSIST_ONLY`사용 
- SET PERSIST_ONLY
  - 정적 변수의 값을 영구 변경하고자 할 때도 사용 가능 
  - 정적인 변수는 실행 중인 서버에서 변경 불가. -> 서버가 재시작될 때만 변경될 수 있음 
  - 정적 변수를 mysqld-auto.cnf 파일에 기록 해두고자 할 때 해당 명령 사용 
- 변경된 시스템 변수의 메타데이터는 `performance_schema.variables_info`뷰와 `performance_schema.persisted_variables`테이블을 통해 참조 가능 


### RESET PERSIST
- mysqld-auto.cnf 파일의 내용을 삭제해야 하는 경우 사용
  - `RESET PERSIST max_connections`


## my.cnf
- MySQL 8.0의 시스템 변수는 대략 570개 
- MySQL 서버를 제대로 활용하려면 시스템 변수에 대한 이해가 상당히 많이 필요함 

